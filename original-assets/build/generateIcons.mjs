import { writeFile } from 'fs/promises';
import { dirname, join } from 'path';
import { fileURLToPath } from 'url';
import * as simpleIcons from 'simple-icons';

const __dirname = dirname(fileURLToPath(import.meta.url));
const targetFile = join(__dirname, '../../simpleicons.go');

let goFileContent = `package main

// Code generated by original-assets/build/generateIcons.mjs; DO NOT EDIT.

var simpleIcons = map[string]string{
`;

for (const icon of Object.values(simpleIcons)) {
  // The SVG from simple-icons has width and height attributes.
  // The class="icon" is used in the old implementation.
  // The CSS probably styles it.
  // Let's remove width and height and add the class.
  const svg = icon.svg.replace(' width="24" height="24"', '').replace('<svg', '<svg class="icon"');
  goFileContent += `\t"${icon.slug}": \`${svg}\`,\n`;
}

goFileContent += `}
`;

await writeFile(targetFile, goFileContent);

console.log(`Generated ${targetFile} with ${Object.keys(simpleIcons).length} icons.`);
